<import src="../../resources/templates/articleCards/index.wxml" />

<!--index.wxml-->
<view class="container" bindtouchstart="swipeLeft" bindtouchend="swipeEnd" bindtouchmove="swiping">

    <view class="topBar">
        <!-- top tab -->
        <view class="subTabContainer">
            <view wx:for="{{subTab}}" class="{{currentTab === index ? 'yellowColor' : ''}};{{windowSize.width < 350 ? 'small-padding' : ' '}}" wx:key="{{*index}}" data-index="{{index}}" bindtap="changeCurrentTap">
                {{item}}
            </view>
        </view>

        <view class="gap"></view>

        <!-- location -->
        <view class="location-container">
            <view class="address">{{location.address}}</view>
            <image class="location-image" src="{{locationIcon}}" />
        </view>

        <!-- TODO: search -->
        <!-- search -->
        <view class="search-container">
            <view class="search-bar-container">
                <image class="search-icon" src="{{searchIcon}}" bindtap="rollToSearchView" />
            </view>
        </view>
    </view>

    <view class="block"></view>

    <!-- slide image -->
    <view class="tabPage1" wx:if="{{currentTab === 0}}">
        <view class="slide-container">
            <!-- slide image core code -->
            <swiper circular="true" autoplay="true" interval="3000" duration="500" class="picture-swiper">
                <swiper-item wx:for-items="{{posters}}" wx:key="{{*index}}" bindtap="rollToActivityDetails">
                    <view class="imageContainer">
                        <image src="{{item.image}}" class="slide-image" />
                    </view>
                </swiper-item>
            </swiper>
        </view>

        <!-- article-calendar-container -->
        <view class="articles-container">
            <view class="articles" wx:if="{{articlesItem.articlesInOneDay.length>0}}" wx:for="{{articlesInOneMonth}}" data-index="{{index}}" bindtap="makeVisited" wx:for-item="articlesItem" wx:key="{{*index}}">
                <view class="date">
                    {{articlesItem.date}}
                </view>

                <view class="articlesInOneDay">
                    <view class="article" wx:for="{{articlesItem.articlesInOneDay}}" wx:for-item="article" wx:key="{{*index}}" bindtap="rollToWebview">
                        <view class="picture">
                            <image src="{{article.image}}"></image>
                        </view>

                        <view class="content">
                            <view class="title {{windowSize.width < 350 ? 'oneLineText' : ''}}">
                                {{article.title}}
                            </view>

                            <view class="time">
                                {{article.starttime+"~"+article.endtime}}
                            </view>

                            <view class="location" wx:if="{{article.title.length < 18 || article.location.length < 7}}">
                                {{article.location}}
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
    </view>

    <view wx:if="{{currentTab !== 0}}">
        <view wx:for="{{activities}}" wx:if="{{(currentTab === 1 || (currentTab === 2 && activity.type === 1) || (currentTab === 3 && activity.type !== 1))}}" wx:for-item="activity" wx:key="{{(*index)}}">
            <view class="registration" bindtap="rollToActivityDetails">
                <view class="regis-image">
                    <image src="{{activity.image}}" bindtap="clickActivity" />
                </view>

                <view class="regis-info">
                    <view class="name">{{activity.short_name}}</view>

                    <view class="start-time"> {{activity.starttime}}~{{activity.endtime}}</view>
                    <view class="location">{{activity.location}}</view>
                    <!-- <view class="hoster">
                        中大GBT
                        <view class="host" wx:for="{{regis.hosts}}" wx:for-item="host" wx:key="{{*index}}">
                            {{host.name}}
                        </view>
                    </view> -->
                </view>
            </view>
        </view>
    </view>


</view>